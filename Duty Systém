const { Client, GatewayIntentBits, REST, Routes } = require("discord.js");
const fetch = require("node-fetch");  // Pridajte kni≈ænicu na posielanie HTTP po≈æiadaviek

// üîë Sem vlo≈æte svoj Discord bot token!
const TOKEN = "TU_VLO≈ΩTE_V√Å≈†_BOT_TOKEN";

// üîó Sem vlo≈æte V√°≈° Webhook URL
const WEBHOOK_URL = "https://discord.com/api/webhooks/1356611793203630080/owyoy4vKr5_Wjt5nWNWuYQh3__EQie7z5JgbqEmk7uyIuXGP4hDFZExET4HJqCEt5kOW";

const client = new Client({
    intents: [GatewayIntentBits.Guilds, GatewayIntentBits.GuildMessages, GatewayIntentBits.MessageContent],
});

client.once("ready", () => {
    console.log(`‚úÖ Bot je online! Prihl√°sen√Ω ako ${client.user.tag}`);
});

// üåç Registr√°cia pr√≠kazu /duty
const commands = [
    {
        name: "duty",
        description: "Zobraz√≠ odkaz na Duty str√°nku.",
    },
];

const rest = new REST({ version: "10" }).setToken(TOKEN);

(async () => {
    try {
        console.log("üõ†Ô∏è Registrujem pr√≠kazy...");
        await rest.put(Routes.applicationCommands("ID_TVOJEJ_APLIK√ÅCIE"), { body: commands });
        console.log("‚úÖ Pr√≠kazy zaregistrovan√©!");
    } catch (error) {
        console.error("‚ùå Chyba pri registr√°cii pr√≠kazov:", error);
    }
})();

// üì¢ Odpoveƒè na pr√≠kaz /duty
client.on("interactionCreate", async (interaction) => {
    if (!interaction.isChatInputCommand()) return;

    if (interaction.commandName === "duty") {
        await interaction.reply("üîµ **Zaƒça≈• Duty!** Klikni sem: https://moja-stranka.sk/");

        // Posielame spr√°vu na Discord cez Webhook
        console.log("Odosielam spr√°vu na Webhook...");
        sendToWebhook("üîµ **Zaƒçal Duty!** Klikni sem: https://moja-stranka.sk/");
    }
});

// Funkcia na poslanie spr√°vy do Discord kan√°la cez Webhook
async function sendToWebhook(message) {
    try {
        const response = await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ content: message }),
        });

        if (!response.ok) {
            console.error("Chyba pri posielan√≠ spr√°vy na Webhook:", response.statusText);
        } else {
            console.log("Spr√°va bola √∫spe≈°ne odoslan√° na Webhook.");
        }
    } catch (error) {
        console.error("Chyba pri pokuse o posielanie na Webhook:", error);
    }
}

// üì° Prihl√°senie bota
client.login(TOKEN);
